---
- name: Install Java 8
  package:
    name: openjdk-8-jre
    state: present

- name: Copy the (custom) streama jar
  copy:
    src: tars/
    dest: /opt
    owner: root
    group: root
    mode: '0777'

- name: Untar the archives
  shell: cat /opt/streama.tar.gz.* | tar -C /opt xzvf -

- name: remove the archives
  file:
    path: /opt/streama.tar.gz.*
    state: absent

- name: Create streama service
  template:
    src: streama.j2
    dest: /etc/systemd/system/streama.service

- name: Copy streama configuration
  template:
    src: application.j2
    dest: /opt/application.yml

- name: Start and enable streama service
  service:
    name: streama
    state: started
    enabled: yes
